# IDå¤‰æ›ä»•æ§˜æ›¸

ç«¶é¦¬ãƒ–ãƒƒã‚¯ã¨JRA-VANã®IDä½“ç³»å¤‰æ›ãŠã‚ˆã³åŠ¹ç‡çš„ãªã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ç®¡ç†ã®ä»•æ§˜æ›¸

## ğŸ“‹ ç›®çš„

- ç«¶é¦¬ãƒ–ãƒƒã‚¯ã¨JRA-VANé–“ã§IDå¤‰æ›ã‚’åŠ¹ç‡åŒ–
- ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’æ´»ç”¨ã—ã¦é«˜é€Ÿæ¤œç´¢ã‚’å®Ÿç¾
- éƒ½åº¦ä»•æ§˜ã‚’èª¿ã¹ã‚‹å¿…è¦ã‚’ãªãã™

## ğŸ”‘ IDä½“ç³»ä¸€è¦§

### 1. é¦¬ID (Horse ID)

#### JRA-VAN: è¡€çµ±ç™»éŒ²ç•ªå·ï¼ˆ10æ¡ï¼‰

| é …ç›® | èª¬æ˜ | ä¾‹ |
|-----|------|-----|
| å½¢å¼ | 10æ¡æ•°å€¤ï¼ˆã‚¼ãƒ­åŸ‹ã‚ï¼‰ | `2020104764` |
| ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å | `KettoNum` | - |
| ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ | UM_DATA, CK_DATA, SE_DATA | - |
| ä¸€æ„æ€§ | å…¨å›½ã§ä¸€æ„ï¼ˆJRAã®å…¬å¼IDï¼‰ | - |

**æ§‹æˆ**:
- å…ˆé ­4æ¡: ç”Ÿå¹´ (ä¾‹: `2020` = 2020å¹´ç”Ÿã¾ã‚Œ)
- æ®‹ã‚Š6æ¡: é€£ç•ª

#### ç«¶é¦¬ãƒ–ãƒƒã‚¯: umacdï¼ˆå½¢å¼ä¸æ˜ï¼‰

| é …ç›® | èª¬æ˜ | ä¾‹ |
|-----|------|-----|
| å½¢å¼ | ä¸æ˜ï¼ˆè¦èª¿æŸ»ï¼‰ | ? |
| ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ | ç«¶é¦¬ãƒ–ãƒƒã‚¯APIãƒ»ã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚° | - |
| ä¸€æ„æ€§ | ç«¶é¦¬ãƒ–ãƒƒã‚¯å†…ã§ä¸€æ„ | - |

**ç¾çŠ¶**: ç«¶é¦¬ãƒ–ãƒƒã‚¯ã®é¦¬IDã¯ä»•æ§˜ãŒä¸æ˜ã®ãŸã‚ã€**é¦¬åã‚’çµŒç”±ã—ã¦å¤‰æ›**

### 2. ãƒ¬ãƒ¼ã‚¹ID (Race ID)

#### JRA-VAN: 16æ¡ãƒ¬ãƒ¼ã‚¹ID

| é …ç›® | èª¬æ˜ | ä¾‹ |
|-----|------|-----|
| å½¢å¼ | 16æ¡ï¼ˆYYYYMMDDJJKKNNRRï¼‰ | `2026012406010208` |
| ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ | DE_DATA (DR*.DAT), SE_DATA (SR*.DAT) | - |

**æ§‹æˆè¦ç´ **:

| ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ | ãƒã‚¤ãƒˆæ•° | èª¬æ˜ | ä¾‹ |
|-----------|---------|------|-----|
| Year | 4 | é–‹å‚¬å¹´ | `2026` |
| Month | 2 | é–‹å‚¬æœˆ | `01` |
| Day | 2 | é–‹å‚¬æ—¥ | `24` |
| JyoCD | 2 | ç«¶é¦¬å ´ã‚³ãƒ¼ãƒ‰ (01-10) | `06` (ä¸­å±±) |
| Kaiji | 2 | å›æ¬¡ | `01` (1å›) |
| Nichiji | 2 | æ—¥æ¬¡ | `02` (2æ—¥ç›®) |
| RaceNum | 2 | ãƒ¬ãƒ¼ã‚¹ç•ªå· (01-12) | `08` (8R) |

#### ç«¶é¦¬ãƒ–ãƒƒã‚¯: URLå½¢å¼ãƒ¬ãƒ¼ã‚¹ID

| é …ç›® | èª¬æ˜ | ä¾‹ |
|-----|------|-----|
| å½¢å¼ | URLãƒ‘ã‚¹ï¼ˆYYYYMMDD + ãƒ¬ãƒ¼ã‚¹ç•ªå·?ï¼‰ | `/race/2026010608/` |
| ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ | ç«¶é¦¬ãƒ–ãƒƒã‚¯URL | - |

**ç¾çŠ¶ã®èª²é¡Œ**:
- ç«¶é¦¬ãƒ–ãƒƒã‚¯ã®ãƒ¬ãƒ¼ã‚¹IDä»•æ§˜ãŒä¸æ˜
- JRA-VANã®16æ¡IDã¨ã®å¯¾å¿œä»˜ã‘ãŒå¿…è¦
- ç«¶é¦¬å ´åãƒ»æ—¥ä»˜ã‹ã‚‰æ¨æ¸¬ã—ã¦å¤‰æ›ã™ã‚‹å¿…è¦ã‚ã‚Š

### 3. ç«¶é¦¬å ´ã‚³ãƒ¼ãƒ‰ (Track Code)

#### JRA-VAN: JyoCDï¼ˆ2æ¡ï¼‰

| ã‚³ãƒ¼ãƒ‰ | ç«¶é¦¬å ´å | è‹±å­—ç•¥ç§° |
|-------|---------|---------|
| 01 | æœ­å¹Œ | SAP |
| 02 | å‡½é¤¨ | HAK |
| 03 | ç¦å³¶ | FUK |
| 04 | æ–°æ½Ÿ | NII |
| 05 | æ±äº¬ | TOK |
| 06 | ä¸­å±± | NAK |
| 07 | ä¸­äº¬ | CHU |
| 08 | äº¬éƒ½ | KYO |
| 09 | é˜ªç¥ | HAN |
| 10 | å°å€‰ | KOK |

#### ç«¶é¦¬ãƒ–ãƒƒã‚¯: ç«¶é¦¬å ´åï¼ˆæ—¥æœ¬èªï¼‰

ç«¶é¦¬ãƒ–ãƒƒã‚¯ã§ã¯ç«¶é¦¬å ´åã‚’æ—¥æœ¬èªæ–‡å­—åˆ—ã§ç®¡ç†ï¼ˆä¾‹: `"ä¸­å±±"`, `"æ±äº¬"`ï¼‰

### 4. èª¿æ•™å¸«ID (Trainer ID)

#### JRA-VAN: èª¿æ•™å¸«ã‚³ãƒ¼ãƒ‰ï¼ˆ5æ¡ï¼‰

| é …ç›® | èª¬æ˜ | ä¾‹ |
|-----|------|-----|
| å½¢å¼ | 5æ¡æ•°å€¤ï¼ˆã‚¼ãƒ­åŸ‹ã‚ï¼‰ | `01234` |
| ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å | `ChokyoshiCode` | - |
| ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ | UM_DATA | - |
| ãƒ¬ã‚³ãƒ¼ãƒ‰ä½ç½® | offset 850-854 (5ãƒã‚¤ãƒˆ) | - |

**èª¿æ•™å¸«å**: offset 855-862 (8ãƒã‚¤ãƒˆ)  
**æ‰€å±**: offset 849 (1ãƒã‚¤ãƒˆã€1=ç¾æµ¦/2=æ —æ±)

#### ç«¶é¦¬ãƒ–ãƒƒã‚¯: å©èˆID

| é …ç›® | èª¬æ˜ | ä¾‹ |
|-----|------|-----|
| å½¢å¼ | åŠè§’ã‚«ãƒŠ1æ–‡å­— + 3æ¡æ•°å­— | `ï½³011` |
| URLå½¢å¼ | URLã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ | `%EF%BD%B3011` |
| ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ | ç«¶é¦¬ãƒ–ãƒƒã‚¯å‡ºèµ°è¡¨ | - |
| URLãƒ‘ã‚¿ãƒ¼ãƒ³ | `/db/kyusya/{å©èˆID}` | `/db/kyusya/%EF%BD%B3011` |

**å¤‰æ›æ–¹æ³•**:
```python
from common.jravan import get_trainer_jvn_code

# ç«¶é¦¬ãƒ–ãƒƒã‚¯å©èˆID â†’ JRA-VANèª¿æ•™å¸«ã‚³ãƒ¼ãƒ‰
jvn_code = get_trainer_jvn_code("ï½³011")
# => "01234"
```

**æ³¨æ„äº‹é …**:
- åŠè§’ã‚«ãƒŠã®URLã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã«æ³¨æ„ï¼ˆ`urllib.parse.unquote()`ã‚’ä½¿ç”¨ï¼‰
- ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã‚’äº‹å‰æ§‹ç¯‰ã™ã‚‹å¿…è¦ã‚ã‚Šï¼ˆ`scripts/build_trainer_index.py`ï¼‰
- åˆæœŸç‰ˆã¯æ‰‹å‹•ãƒãƒƒãƒ”ãƒ³ã‚°ã€å°†æ¥ã¯è‡ªå‹•åå¯„ã›ãƒ­ã‚¸ãƒƒã‚¯ã‚’å®Ÿè£…äºˆå®š

## ğŸ”„ IDå¤‰æ›æ–¹æ³•

### èª¿æ•™å¸«IDå¤‰æ›

#### ç«¶é¦¬ãƒ–ãƒƒã‚¯ â†’ JRA-VAN

**æ–¹æ³•**: ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½¿ç”¨ã—ã¦å¤‰æ›

```python
from common.jravan import get_trainer_jvn_code

# 1. ç«¶é¦¬ãƒ–ãƒƒã‚¯ã‹ã‚‰å©èˆIDã‚’å–å¾—ï¼ˆã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°ï¼‰
trainer_id = "ï½³011"

# 2. JRA-VANèª¿æ•™å¸«ã‚³ãƒ¼ãƒ‰ã«å¤‰æ›
jvn_code = get_trainer_jvn_code(trainer_id)
# => "01234"
```

**æ³¨æ„ç‚¹**:
- ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ`data/trainer_id_index.json`ï¼‰ã‚’äº‹å‰æ§‹ç¯‰
- è¦‹ã¤ã‹ã‚‰ãªã„å ´åˆã¯`None`ã‚’è¿”ã™
- èª¿æ•™å¸«æƒ…å ±å…¨ä½“ã‚’å–å¾—ã™ã‚‹å ´åˆã¯`get_trainer_info()`ã‚’ä½¿ç”¨

#### JRA-VAN â†’ ç«¶é¦¬ãƒ–ãƒƒã‚¯

**æ–¹æ³•**: èª¿æ•™å¸«ã‚³ãƒ¼ãƒ‰ã‹ã‚‰èª¿æ•™å¸«åã‚’å–å¾—ã—ã€ç«¶é¦¬ãƒ–ãƒƒã‚¯ã§æ¤œç´¢

```python
from common.jravan.trainer_mapper import TrainerIdMapper

# 1. JRA-VANèª¿æ•™å¸«ã‚³ãƒ¼ãƒ‰ã‹ã‚‰èª¿æ•™å¸«åã‚’å–å¾—ï¼ˆUM_DATAã‹ã‚‰ï¼‰
# ï¼ˆå°†æ¥å®Ÿè£…äºˆå®šï¼‰

# 2. ç«¶é¦¬ãƒ–ãƒƒã‚¯ã§èª¿æ•™å¸«åæ¤œç´¢ï¼ˆã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°ç­‰ï¼‰
# keibabook_url = search_keibabook_trainer(trainer_name)
```

### é¦¬IDå¤‰æ›

#### ç«¶é¦¬ãƒ–ãƒƒã‚¯ â†’ JRA-VAN

**æ–¹æ³•**: é¦¬åã‚’çµŒç”±ã—ã¦UM_DATAã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‹ã‚‰å¤‰æ›

```python
from common.jravan import get_horse_id_by_name

# 1. ç«¶é¦¬ãƒ–ãƒƒã‚¯ã‹ã‚‰é¦¬åã‚’å–å¾—ï¼ˆä¾‹: ã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°ï¼‰
horse_name = "ãƒ‰ã‚¦ãƒ‡ãƒ¥ãƒ¼ã‚¹"

# 2. é¦¬åã‹ã‚‰JRA-VAN 10æ¡IDã«å¤‰æ›
jvn_horse_id = get_horse_id_by_name(horse_name)
# => "2019103487"
```

**æ³¨æ„ç‚¹**:
- é¦¬åãŒå®Œå…¨ä¸€è‡´ã™ã‚‹å¿…è¦ã‚ã‚Š
- åŒåé¦¬ãŒã„ã‚‹å ´åˆã¯æ³¨æ„ï¼ˆæœ€æ–°ã®é¦¬ãŒå„ªå…ˆã•ã‚Œã‚‹ï¼‰
- ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’äº‹å‰æ§‹ç¯‰ã—ã¦ãŠãï¼ˆåˆå›ã®ã¿ï¼‰

#### JRA-VAN â†’ ç«¶é¦¬ãƒ–ãƒƒã‚¯

**æ–¹æ³•**: JRA-VANã‹ã‚‰é¦¬åã‚’å–å¾—ã—ã€ç«¶é¦¬ãƒ–ãƒƒã‚¯ã§æ¤œç´¢

```python
from common.jravan.um_parser import find_horse_by_id

# 1. JRA-VAN IDã‹ã‚‰é¦¬æƒ…å ±ã‚’å–å¾—
horse = find_horse_by_id("2019103487")
horse_name = horse.name  # => "ãƒ‰ã‚¦ãƒ‡ãƒ¥ãƒ¼ã‚¹"

# 2. ç«¶é¦¬ãƒ–ãƒƒã‚¯ã§é¦¬åæ¤œç´¢ï¼ˆã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°ç­‰ï¼‰
# keibabook_url = search_keibabook_horse(horse_name)
```

### ãƒ¬ãƒ¼ã‚¹IDå¤‰æ›

#### JRA-VAN â†’ ç«¶é¦¬ãƒ–ãƒƒã‚¯ï¼ˆæ¨å®šï¼‰

JRA-VANã®16æ¡IDã‹ã‚‰ç«¶é¦¬ãƒ–ãƒƒã‚¯URLã‚’æ¨å®š:

```python
from common.jravan.race_id import parse_race_id, format_date

# JRA-VAN ãƒ¬ãƒ¼ã‚¹ID
jvn_race_id = "2026012406010208"

# ãƒ‘ãƒ¼ã‚¹
race_info = parse_race_id(jvn_race_id)
# {
#   "year": "2026",
#   "month": "01",
#   "day": "24",
#   "track_code": "06",
#   "track_name": "ä¸­å±±",
#   "kaiji": "01",
#   "nichiji": "02",
#   "race_num": "08"
# }

# ç«¶é¦¬ãƒ–ãƒƒã‚¯URLæ¨å®šï¼ˆä»•æ§˜è¦ç¢ºèªï¼‰
date_str = f"{race_info['year']}{race_info['month']}{race_info['day']}"
race_num_str = race_info['race_num']
# keibabook_url = f"/race/{date_str}{race_num_str}/"
# => "/race/2026012408/"
```

#### ç«¶é¦¬ãƒ–ãƒƒã‚¯ â†’ JRA-VAN

ç«¶é¦¬ãƒ–ãƒƒã‚¯ã®ãƒ¬ãƒ¼ã‚¹ãƒšãƒ¼ã‚¸ã‹ã‚‰æƒ…å ±ã‚’å–å¾—ã—ã¦JRA-VAN IDã‚’æ§‹ç¯‰:

```python
from common.jravan.race_id import build_race_id

# ç«¶é¦¬ãƒ–ãƒƒã‚¯ã‹ã‚‰å–å¾—ã—ãŸæƒ…å ±
race_data = {
    "date": "2026-01-24",
    "track": "ä¸­å±±",
    "kaiji": 1,
    "nichiji": 2,
    "race_num": 8
}

# JRA-VAN ãƒ¬ãƒ¼ã‚¹IDæ§‹ç¯‰
jvn_race_id = build_race_id(
    year=2026,
    month=1,
    day=24,
    track_code="06",  # ä¸­å±±
    kaiji=1,
    nichiji=2,
    race_num=8
)
# => "2026012406010208"
```

### ç«¶é¦¬å ´åå¤‰æ›

#### åå‰ â†’ ã‚³ãƒ¼ãƒ‰

```python
from common.jravan.track_codes import get_track_code

track_code = get_track_code("ä¸­å±±")
# => "06"
```

#### ã‚³ãƒ¼ãƒ‰ â†’ åå‰

```python
from common.jravan.track_codes import get_track_name

track_name = get_track_name("06")
# => "ä¸­å±±"
```

## ğŸ“Š ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ç®¡ç†

### é¦¬åã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹

**ç›®çš„**: é¦¬å â†’ JRA-VAN 10æ¡ID ã®é«˜é€Ÿå¤‰æ›

**ãƒ•ã‚¡ã‚¤ãƒ«**: `KeibaCICD.TARGET/data/horse_name_index.json`

**æ§‹é€ **:
```json
{
  "meta": {
    "created_at": "2026-01-30T10:00:00",
    "count": 150000,
    "source": "E:/TFJV/UM_DATA"
  },
  "index": {
    "ãƒ‰ã‚¦ãƒ‡ãƒ¥ãƒ¼ã‚¹": "2019103487",
    "ã‚¤ã‚¯ã‚¤ãƒãƒƒã‚¯ã‚¹": "2019105091",
    "ã‚¸ãƒ£ã‚¹ãƒ†ã‚£ãƒ³ãƒ‘ãƒ¬ã‚¹": "2019105015"
  }
}
```

**æ§‹ç¯‰æ–¹æ³•**:
```powershell
python scripts/horse_id_mapper.py --build-index
```

**æ›´æ–°é »åº¦**: åŠæœŸã”ã¨ï¼ˆ1æœˆãƒ»7æœˆï¼‰ã«UM_DATAãŒæ›´æ–°ã•ã‚ŒãŸã‚‰å†æ§‹ç¯‰

### ãƒ¬ãƒ¼ã‚¹IDã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ï¼ˆæœªå®Ÿè£…ãƒ»ææ¡ˆï¼‰

**ç›®çš„**: æ—¥ä»˜+ç«¶é¦¬å ´+ãƒ¬ãƒ¼ã‚¹ç•ªå· â†’ JRA-VAN 16æ¡ID ã®é«˜é€Ÿå¤‰æ›

**ãƒ•ã‚¡ã‚¤ãƒ«æ¡ˆ**: `KeibaCICD.TARGET/data/race_id_index.json`

**æ§‹é€ æ¡ˆ**:
```json
{
  "2026-01-24": {
    "ä¸­å±±": {
      "kaiji": 1,
      "nichiji": 2,
      "races": {
        "1": "2026012406010201",
        "2": "2026012406010202",
        "8": "2026012406010208"
      }
    }
  }
}
```

**æ§‹ç¯‰æ–¹æ³•æ¡ˆ**:
```python
# DE_DATAã‹ã‚‰æ—¥ä»˜ãƒ»ç«¶é¦¬å ´ãƒ»ãƒ¬ãƒ¼ã‚¹ç•ªå·ã‚’èª­ã¿å–ã‚Šã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹åŒ–
from common.jravan.race_id import build_race_index

build_race_index(start_date="2024-01-01", end_date="2026-12-31")
```

## ğŸ¯ å®Ÿç”¨ãƒ‘ã‚¿ãƒ¼ãƒ³

### ãƒ‘ã‚¿ãƒ¼ãƒ³1: ç«¶é¦¬ãƒ–ãƒƒã‚¯ã®å‡ºèµ°é¦¬ãƒ‡ãƒ¼ã‚¿ã«JRA-VANèª¿æ•™ãƒ‡ãƒ¼ã‚¿ã‚’ç´ä»˜ã‘

```python
from common.jravan import get_horse_id_by_name, analyze_horse_training

# 1. ç«¶é¦¬ãƒ–ãƒƒã‚¯ã‹ã‚‰å‡ºèµ°é¦¬åã‚’å–å¾—
horses_from_keibabook = ["ãƒ‰ã‚¦ãƒ‡ãƒ¥ãƒ¼ã‚¹", "ã‚¤ã‚¯ã‚¤ãƒãƒƒã‚¯ã‚¹", "ã‚¸ãƒ£ã‚¹ãƒ†ã‚£ãƒ³ãƒ‘ãƒ¬ã‚¹"]

# 2. å„é¦¬ã®èª¿æ•™ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
race_date = "20260125"
for horse_name in horses_from_keibabook:
    # é¦¬åâ†’JRA-VAN IDã«å¤‰æ›
    jvn_id = get_horse_id_by_name(horse_name)

    if jvn_id:
        # JRA-VANã‹ã‚‰èª¿æ•™ãƒ‡ãƒ¼ã‚¿å–å¾—
        training = analyze_horse_training(jvn_id, race_date, days_back=14)

        print(f"{horse_name} (ID: {jvn_id})")
        if training["final"]:
            final = training["final"]
            print(f"  æœ€çµ‚è¿½åˆ‡: {final['date']} {final['center']}{final['location']}")
            print(f"  4F={final['time_4f']:.1f}s [{final['speed_class']}]")
    else:
        print(f"{horse_name}: JRA-VAN IDãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“")
```

### ãƒ‘ã‚¿ãƒ¼ãƒ³2: JRA-VANé¦¬IDã‹ã‚‰ç«¶é¦¬ãƒ–ãƒƒã‚¯é¦¬æƒ…å ±ãƒšãƒ¼ã‚¸ã‚’æ¤œç´¢

```python
from common.jravan.um_parser import find_horse_by_id
import requests

# 1. JRA-VANé¦¬IDã‹ã‚‰é¦¬åã‚’å–å¾—
jvn_id = "2019103487"
horse = find_horse_by_id(jvn_id)

if horse:
    horse_name = horse.name

    # 2. ç«¶é¦¬ãƒ–ãƒƒã‚¯ã§é¦¬åæ¤œç´¢ï¼ˆAPIã¾ãŸã¯ã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°ï¼‰
    # search_url = f"https://www.keibabook.co.jp/search?q={horse_name}"
    # response = requests.get(search_url)
    # ...
```

### ãƒ‘ã‚¿ãƒ¼ãƒ³3: ç«¶é¦¬ãƒ–ãƒƒã‚¯ãƒ¬ãƒ¼ã‚¹ãƒšãƒ¼ã‚¸ã‹ã‚‰JRA-VANãƒ¬ãƒ¼ã‚¹ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—

```python
from common.jravan.race_id import build_race_id
from common.jravan.race_parser import get_race_info

# 1. ç«¶é¦¬ãƒ–ãƒƒã‚¯ã‹ã‚‰å–å¾—ã—ãŸæƒ…å ±
race_info = {
    "date": "2026-01-24",
    "track": "ä¸­å±±",
    "race_num": 8,
    # å›æ¬¡ãƒ»æ—¥æ¬¡ã¯æ¨å®šã¾ãŸã¯åˆ¥é€”å–å¾—ãŒå¿…è¦
}

# 2. JRA-VAN ãƒ¬ãƒ¼ã‚¹IDã‚’æ§‹ç¯‰
# â€» å›æ¬¡ãƒ»æ—¥æ¬¡ã®æƒ…å ±ãŒå¿…è¦ï¼ˆDE_DATAã‹ã‚‰å–å¾—ãªã©ï¼‰
jvn_race_id = build_race_id(
    year=2026, month=1, day=24,
    track_code="06",  # ä¸­å±±
    kaiji=1,  # è¦ç¢ºèª
    nichiji=2,  # è¦ç¢ºèª
    race_num=8
)

# 3. JRA-VANã‹ã‚‰ãƒ¬ãƒ¼ã‚¹ãƒ‡ãƒ¼ã‚¿å–å¾—
race_data = get_race_info(jvn_race_id)
```

## ğŸ” ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### é¦¬åã§å¤‰æ›ã§ããªã„

**åŸå› 1**: ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãŒæ§‹ç¯‰ã•ã‚Œã¦ã„ãªã„

```powershell
python scripts/horse_id_mapper.py --build-index
```

**åŸå› 2**: é¦¬åãŒå¾®å¦™ã«ç•°ãªã‚‹

```python
# éƒ¨åˆ†ä¸€è‡´ã§æ¤œç´¢
from common.jravan.um_parser import search_horses_by_name

horses = search_horses_by_name("ãƒ‰ã‚¦ãƒ‡")
for h in horses:
    print(f"{h.ketto_num}: {h.name}")
```

**åŸå› 3**: å¤ã„é¦¬ã§UM_DATAã«å­˜åœ¨ã—ãªã„

â†’ éå»10å¹´åˆ†ã®UM_DATAãŒå¿…è¦ï¼ˆã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹æ§‹ç¯‰æ™‚ã«æŒ‡å®šï¼‰

### ãƒ¬ãƒ¼ã‚¹IDå¤‰æ›ã§å›æ¬¡ãƒ»æ—¥æ¬¡ãŒä¸æ˜

**è§£æ±ºç­–**: DE_DATAã‹ã‚‰å–å¾—

```python
from common.jravan.race_parser import find_race_by_date_and_track

# æ—¥ä»˜ã¨ç«¶é¦¬å ´ã‹ã‚‰ãƒ¬ãƒ¼ã‚¹æƒ…å ±ã‚’æ¤œç´¢
races = find_race_by_date_and_track("2026-01-24", "ä¸­å±±")
for race in races:
    print(f"å›æ¬¡={race.kaiji} æ—¥æ¬¡={race.nichiji} {race.race_num}R")
```

## ğŸ“š é–¢é€£ãƒªã‚½ãƒ¼ã‚¹

### ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå†…

- [horse_id_mapper.py](../../scripts/horse_id_mapper.py) - é¦¬åâ†’IDå¤‰æ›ãƒ„ãƒ¼ãƒ«
- [UM_DATAä»•æ§˜](./data-types/UM_DATA.md) - é¦¬ãƒã‚¹ã‚¿ãƒ‡ãƒ¼ã‚¿
- [DE_DATAä»•æ§˜](./data-types/DE_DATA.md) - ãƒ¬ãƒ¼ã‚¹ãƒ‡ãƒ¼ã‚¿

### ä»Šå¾Œã®å®Ÿè£…äºˆå®š

1. **ãƒ¬ãƒ¼ã‚¹IDã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹**: æ—¥ä»˜+ç«¶é¦¬å ´ã‹ã‚‰JRA-VAN IDã‚’é«˜é€Ÿå–å¾—
2. **ç«¶é¦¬ãƒ–ãƒƒã‚¯APIé€£æº**: å…¬å¼APIãŒã‚ã‚Œã°ç›´æ¥å¤‰æ›
3. **ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ©Ÿæ§‹**: ä¸€åº¦å¤‰æ›ã—ãŸIDã‚’ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã—ã¦é«˜é€ŸåŒ–

---

*æœ€çµ‚æ›´æ–°: 2026-01-30*
