# AI協調開発プロトコル v1.0

> カカシ（Claude Code）、ふくだ君、Cursor による協調開発のルール

---

## 📋 概要

**目的**: 複数のAIエージェントが非同期で協調開発を行うためのプロトコル

**原則**:
- **非同期コミュニケーション**: リアルタイム会話は不要
- **履歴の透明性**: 全ての意思決定を記録
- **役割の明確化**: 誰が何を担当するか明示

---

## 👥 チームメンバーと役割

| メンバー | 役割 | 責任範囲 |
|---------|------|---------|
| **カカシ** (Claude Code) | 設計・計画・レビュー | アーキテクチャ設計、プラン作成、コードレビュー、ドキュメント作成 |
| **ふくだ君** | プロジェクトオーナー | 意思決定、優先順位付け、承認、情報伝達 |

### 実装チーム「木ノ葉の精鋭」

| メンバー | 役割 | 担当領域 | 専門技術 |
|---------|------|---------|---------|
| **テンテン** | フロントエンド開発 | React/Next.js UI実装 | TypeScript, React, SWR, Tailwind CSS |
| **ネジ** | ドメイン層ロジック | Python ビジネスロジック | Python, pandas, データ処理、分析ロジック |
| **リー** | インフラ・バッチ | データパイプライン、自動化 | Bash, PowerShell, バッチ処理、CI/CD |

**キャラクター特性との対応**:
- **テンテン**: 武器使い → 多様なツール・ライブラリを使いこなす
- **ネジ**: 白眼で見通す → ロジックの細部を精密に実装
- **リー**: 体術の基礎 → システムの基盤を支える

**将来的な拡張**:
- v5.0以降: キバ（データ分析）、シカマル（戦略立案）、ヒナタ（品質保証）等を追加予定

---

## 📂 conversations/ フォルダ構造

### ディレクトリ構造

```
keiba-cicd-core/conversations/
├── 2026-02-07_v3.1-swr-introduction/
│   ├── 00_plan.md                 # カカシ作成
│   ├── 01_instruction.md          # ふくだ君作成（Cursor向け）
│   ├── 02_implementation.md       # Cursor作成
│   ├── 03_review.md               # カカシ作成
│   ├── 04_instruction.md          # 追加指示（必要に応じて）
│   ├── 05_implementation.md       # 追加実装報告
│   └── 90_summary.md              # 最終サマリ
├── 2026-02-10_training-db-setup/
│   └── ...
└── README.md                      # このプロトコルへのリンク
```

### 命名規則

#### フォルダ名
- フォーマット: `YYYY-MM-DD_{タスク名}/`
- 例: `2026-02-07_v3.1-swr-introduction/`
- タスク名: ケバブケース（小文字、ハイフン区切り）

#### ファイル名
- フォーマット: `{連番}_{種類}.md`
- 連番:
  - `00-09`: プラン・指示
  - `10-19`: 実装報告（将来的に複数イテレーション用）
  - `20-29`: レビュー
  - `30-89`: 予約（将来拡張用）
  - `90-99`: サマリ・振り返り

---

## 🔄 開発フロー

### 標準フロー（5ステップ）

```
┌─────────────┐
│ 1. プラン   │ カカシ → 00_plan.md
└──────┬──────┘
       ↓
┌─────────────┐
│ 2. 指示     │ ふくだ君 → 01_instruction.md
└──────┬──────┘
       ↓
┌─────────────┐
│ 3. 実装     │ Cursor → 02_implementation.md
└──────┬──────┘
       ↓
┌─────────────┐
│ 4. レビュー │ カカシ → 03_review.md
└──────┬──────┘
       ↓
┌─────────────┐
│ 5. サマリ   │ カカシ → 90_summary.md
└─────────────┘
```

### イテレーションが必要な場合

修正が必要な場合は、04, 05, 06... と連番を増やして繰り返す：

```
03_review.md → 修正が必要
04_instruction.md → 追加指示
05_implementation.md → 修正実装
06_review.md → 再レビュー
...
90_summary.md → 完了時
```

---

## 📝 ファイルテンプレート

### 00_plan.md（カカシ作成）

```markdown
# {タスク名} - 設計・プラン

**作成者**: カカシ
**作成日**: YYYY-MM-DD
**対象バージョン**: vX.X

---

## 🎯 目的

（なぜこのタスクが必要か）

## 📊 現状分析

（現在の課題・パフォーマンス）

## 🚀 実装方針

### アプローチ
（技術的アプローチの選択理由）

### 期待される効果
- パフォーマンス: XX%改善
- 保守性: （改善内容）

## 📁 変更対象ファイル

- `path/to/file1.tsx` - （変更内容）
- `path/to/file2.ts` - （変更内容）

## ⚙️ 技術的留意点

- （重要な設計判断）
- （落とし穴・注意点）

## 📚 参考資料

- [SWR Documentation](https://swr.vercel.app/)
- （関連する技術書の章）

---

**次のアクション**: ふくだ君が承認後、`01_instruction.md` 作成
```

### 01_instruction.md（ふくだ君作成）

```markdown
# {タスク名} - 実装指示

**作成者**: ふくだ君
**作成日**: YYYY-MM-DD
**指示先**: Cursor

---

## 📋 タスク概要

（カカシのプランから要約）

## 🎯 実装内容

### 対象ファイル
- `path/to/file1.tsx`
- `path/to/file2.ts`

### 具体的な変更
1. （ステップ1）
2. （ステップ2）
3. （ステップ3）

## 📖 参考コード

```typescript
// カカシのプランから抜粋
// または既存の類似実装への参照
```

## ✅ 完了条件

- [ ] TypeScriptエラーなし
- [ ] 手動テストで動作確認
- [ ] 変更ファイル一覧を報告

---

**次のアクション**: 実装完了後、`02_implementation.md` に報告
```

### 02_implementation.md（実装チーム作成）

```markdown
# {タスク名} - 実装報告

**作成者**: Cursor
**担当**: テンテン / ネジ / リー（該当者を記載）
**作成日**: YYYY-MM-DD

---

## ✅ 実施内容

- [x] （完了した項目1）
- [x] （完了した項目2）
- [ ] （未完了・保留項目）

## 📁 変更ファイル

| ファイル | 変更行数 | 変更内容 |
|---------|---------|---------|
| `path/to/file1.tsx` | +25 -10 | SWR導入 |
| `path/to/file2.ts` | +5 -2 | 型定義追加 |

## 🧪 テスト結果

### 手動テスト
- ✅ レース詳細ページ表示: OK
- ✅ データキャッシング動作: OK

### 自動テスト
- ✅ TypeScript: エラーなし
- ⚠️ ESLint: 警告1件（unused import）

## ⚠️ 課題・疑問点

- （未解決の問題）
- （判断に迷った点）

## 📸 スクリーンショット（必要に応じて）

（実装結果の画面キャプチャ）

---

**次のアクション**: カカシにレビュー依頼
```

### 03_review.md（カカシ作成）

```markdown
# {タスク名} - レビュー結果

**作成者**: カカシ
**作成日**: YYYY-MM-DD

---

## ✅ 良い点

- （評価するポイント）
- （ベストプラクティスへの準拠）

## ⚠️ 修正が必要

### 重要度: 高
- （必ず修正すべき点）

### 重要度: 中
- （できれば修正したい点）

### 重要度: 低（参考）
- （将来的な改善案）

## 📚 学習ポイント

- （この実装から学べること）
- （技術書との関連）

## 🎯 次のステップ

### このタスクについて
- [ ] （修正指示）
- [ ] （追加テスト）

### 次のタスクへ
- （次に取り組むべきタスク）

---

**次のアクション**:
- 修正が必要な場合 → `04_instruction.md` 作成
- 完了の場合 → `90_summary.md` 作成
```

### 90_summary.md（カカシ作成）

```markdown
# {タスク名} - 完了サマリ

**作成者**: カカシ
**作成日**: YYYY-MM-DD
**ステータス**: ✅ 完了

---

## 📊 成果

### 実装内容
- （何を実装したか）

### 変更ファイル
- 変更: X ファイル
- 追加: Y 行
- 削除: Z 行

### パフォーマンス改善
- （実測値・体感）

## 🎓 学習成果

### 技術的学習
- （習得した技術）
- （技術書との関連）

### プロセス改善
- （協調開発プロセスの改善点）

## 📝 振り返り

### うまくいったこと
- （成功要因）

### 改善できること
- （次回への改善案）

## 📚 更新されたドキュメント

- （作成・更新したドキュメント一覧）

---

**このタスクは完了しました** 🎉
```

---

## 🎯 ベストプラクティス

### 1. プラン作成（カカシ）

- ✅ **背景を説明**: なぜ必要か、現状の課題は何か
- ✅ **選択肢を検討**: なぜこのアプローチか、他の選択肢は？
- ✅ **技術書と関連付け**: 学習機会を明示
- ✅ **具体的**: "改善する" ではなく "50%高速化"

### 2. 実装指示（ふくだ君）

- ✅ **明確**: 曖昧な指示を避ける
- ✅ **完了条件を明示**: 何ができたら完了か
- ✅ **参考情報を提供**: 関連コード、ドキュメントへのリンク
- ✅ **優先順位**: 重要度の順に記載

### 3. 実装報告（Cursor）

- ✅ **正直**: できたこと・できなかったことを明確に
- ✅ **証拠**: テスト結果、スクリーンショットを添付
- ✅ **疑問点を共有**: 判断に迷った点は質問
- ✅ **次のレビューアーへの配慮**: 必要な情報を網羅

### 4. レビュー（カカシ）

- ✅ **建設的**: 批判ではなく改善提案
- ✅ **優先順位付け**: 重要度を明示
- ✅ **学習機会**: なぜその修正が必要か説明
- ✅ **ポジティブフィードバック**: 良い点も必ず評価

---

## 🚨 重要な注意事項

### やってはいけないこと

- ❌ **conversations/ を飛ばして直接実装しない**
  - 必ず記録を残す

- ❌ **古いファイルを更新せず新しいファイルを作らない**
  - 同じ連番で上書き更新はNG、新しい連番で追加

- ❌ **サマリなしで次のタスクに進まない**
  - 90_summary.md で振り返りを記録

- ❌ **他のメンバーのファイルを勝手に編集しない**
  - 自分の担当ファイルのみ作成

### 緊急時の対応

バグ修正など緊急の場合でも、**必ず最低限の記録を残す**：

```
conversations/2026-02-XX_hotfix-{issue}/
├── 00_plan.md      # 簡潔でOK
├── 02_implementation.md
└── 90_summary.md
```

---

## 📈 プロセス改善

### 定期的な振り返り

毎月1回、協調開発プロセスを見直す：

1. **うまくいったこと** → 継続
2. **改善できること** → プロトコル更新
3. **新しい試み** → 実験的に導入

### メトリクス

成功を測定する指標：

- ✅ **コミュニケーション効率**: イテレーション回数（少ないほど良い）
- ✅ **学習成果**: 技術書との関連付け数
- ✅ **品質**: レビューでの修正指摘数（減少傾向が良い）
- ✅ **ドキュメント**: summary.md の充実度

---

## 🔗 関連ドキュメント

- [CLAUDE.md](./CLAUDE.md) - AIチーム統合ガイドライン
- [ROADMAP.md](./ROADMAP.md) - v3.1〜v6.0開発計画
- [PERFORMANCE_OPTIMIZATION_V3.1.md](./PERFORMANCE_OPTIMIZATION_V3.1.md) - 最適化計画

---

**策定者**: カカシ（AI相談役）
**承認者**: ふくだ君（プロジェクトオーナー）
**策定日**: 2026-02-07
**バージョン**: 1.0
