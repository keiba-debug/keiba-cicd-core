# 差し馬のサブタイプ: スロー捲り型 vs ハイペース追込型

> 起点: 「スローペースで捲れる差し馬と、ハイペースでタフなペースで追い込む差し馬の違いを考えることについて考察したい」

---

## 1. この区別はなぜ重要か

```
従来の脚質分類:
  逃げ / 先行 / 差し / 追込

この4分類では「差し」が一括りにされている。
しかし実際には「差し」の中に根本的に異なるタイプが存在する:

タイプA: スローペースで自ら動いて捲る差し（能動的差し）
タイプB: ハイペースで前が止まるのを待って差す（受動的差し）

この2タイプは:
  - 好走する展開が真逆
  - 必要な身体能力が異なる
  - 有利になるレース条件が正反対
  - 馬券戦略が全く変わる

にもかかわらず、通過順位ベースの脚質分類では
両方とも「差し」に分類されてしまう。
→ この区別をモデルに教えることで予測精度が向上する可能性がある。
```

---

## 2. 2つのタイプの比較

### タイプA: スロー捲り型（能動的差し）

```
特徴:
  - スローペースのレースで好走する
  - 自ら動いて3-4コーナーでポジションを上げる
  - 「待つ」のではなく「仕掛ける」差し
  - 瞬発力よりも持続的なスピードが武器

身体能力:
  - 中盤から長い脚を使える（持続力型）
  - 加速の瞬間的な破壊力はそこまでではない
  - スタミナが豊富（マクリにはスタミナが必要）
  - ギアチェンジ: 緩→中速を長く維持

典型的な通過順位:
  10-10-5-3 → 1着（3コーナーから動いて先頭に）
  8-8-4-2 → 2着（緩やかにポジションを上げる）

好走する条件:
  ✅ スローペース（前半が遅い）
  ✅ 直線が長いコース（加速を維持する距離がある）
  ✅ 逃げ馬が弱い or いない（前がペースを上げない）
  ✅ 先行馬が手薄（捲るスペースがある）

凡走する条件:
  ❌ ハイペース（自分がさらにペースを上げる余地がない）
  ❌ 先行馬が強い（捲っても差し返される）
  ❌ 小回りコース（捲りのスペースがない）

代表的な馬（イメージ）:
  長い脚を使うタイプ。上がり最速ではないが、
  3Fではなく4-5Fのロングスパートで他馬を凌駕する。
```

### タイプB: ハイペース追込型（受動的差し）

```
特徴:
  - ハイペースのレースで好走する
  - 後方で脚を溜め、直線で一気に差す
  - 前が止まるのを「待つ」差し
  - 瞬発力（上がり3Fの速さ）が武器

身体能力:
  - 短い距離で爆発的な加速力（瞬発力型）
  - 長い脚は使えない（スパートが短い）
  - スタミナよりトップスピードが高い
  - ギアチェンジ: 低速→一気に最高速

典型的な通過順位:
  12-12-11-8 → 1着（最後方から直線だけで差す）
  14-14-13-10 → 3着（大外を回って追い込み）

好走する条件:
  ✅ ハイペース（前が止まる → 差しが届く）
  ✅ 直線が長いコース（瞬発力を発揮する距離が必要）
  ✅ 逃げ馬が複数（ペースが上がる → 先行崩壊）
  ✅ 外が伸びる馬場（大外から追い込める）

凡走する条件:
  ❌ スローペース（前が止まらない → 届かない）
  ❌ 小回りコース（直線が短すぎて届かない）
  ❌ 内が有利な馬場（外を回ると不利）
  ❌ 逃げ馬がいない（ペースが上がらない）

代表的な馬（イメージ）:
  上がり3F最速を連発するが、差し届かないことも多い。
  ハマれば圧勝、ハマらなければ凡走の「一発型」。
```

### 比較表

```
┌──────────────────┬──────────────────┬──────────────────┐
│                  │ スロー捲り型     │ ハイペース追込型 │
├──────────────────┼──────────────────┼──────────────────┤
│ 好走ペース       │ スロー           │ ハイ             │
│ 武器             │ 持続力           │ 瞬発力           │
│ スパート距離     │ 4-5F（ロング）   │ 2-3F（ショート） │
│ 仕掛けタイミング │ 3角（早仕掛け）  │ 直線入口（遅め） │
│ 自ら動くか       │ 能動的           │ 受動的           │
│ 上がり3F         │ 中〜やや速       │ 最速クラス       │
│ 着順安定度       │ やや安定         │ 不安定（一発型） │
│ 有利なコース     │ 中距離、外回り   │ 長直線、外回り   │
│ 不利なコース     │ 小回り短距離     │ 小回り、内回り   │
│ 馬券的な位置づけ │ 堅実な相手       │ 穴馬・ヒモ       │
└──────────────────┴──────────────────┴──────────────────┘
```

---

## 3. JRA-VANデータからどう分類するか

### 3-1. 上がり3Fとスパート距離の間接推定

```
直接的な区別指標:
  「上がり3Fの速さ」と「仕掛けのタイミング」の関係

■ 指標1: 上がり3F順位 vs 3-4角のポジション変動

  スロー捲り型:
    3角でポジションUP（仕掛けが早い）
    上がり3Fは「中の上」程度（全体が速くなるので相対的に普通）
    → (3角順位 - 4角順位) ≥ 3（コーナーで大きくポジションUP）
    → 上がり3F順位: 3-6位（最速ではないが速い）

  ハイペース追込型:
    3-4角ではほぼ動かない（仕掛けが遅い）
    上がり3Fが最速クラス（直線だけで差す）
    → (3角順位 - 4角順位) ≤ 1（コーナーではあまり動かない）
    → 上がり3F順位: 1-2位（圧倒的に速い）

  判定ロジック案:
    if 上がり3F順位 ≤ 2 and (3角順位 - 4角順位) ≤ 1:
        → ハイペース追込型
    elif (3角順位 - 4角順位) ≥ 3 and 4角順位 ≤ 5:
        → スロー捲り型
    else:
        → 中間型（通常の差し）
```

### 3-2. ペース別の成績比較

```
最も直接的な分類方法:
  同じ馬の過去走を「ペース別」にグループ分けして成績比較。

  レースのペース判定:
    RPCI（Race Pace Change Index）を使用
    = 前半3F / 後半3F（全体ペース）
    RPCI > 1.05: ハイペース
    RPCI 0.95-1.05: ミドルペース
    RPCI < 0.95: スローペース

  馬ごとの分類:
    スロー時好走率 > ハイ時好走率 → スロー捲り型
    ハイ時好走率 > スロー時好走率 → ハイペース追込型
    差がない → ペース不問型（汎用型差し）

  ★ サンプルサイズの問題:
    1頭あたりスロー/ハイの好走率を比較するには最低10走程度必要。
    実際にはキャリアが浅い馬が多い → 分類精度に限界。
    → 分類値ではなく「スロー好走率」「ハイ好走率」を
      連続値の特徴量として入れる方が実用的。
```

### 3-3. 通過順位パターンの統計的分類

```
過去N走の通過順位パターンから差しのサブタイプを推定:

特徴量候補:
  ■ 平均仕掛けポイント:
    各走の「ポジションが上がり始めるコーナー」を特定
    スロー捲り型: 平均3角あたりから動く
    ハイペース追込型: 平均4角以降から動く

  ■ ポジション上昇の勾配:
    (1角順位 - ゴール順位) / コーナー数
    スロー捲り型: 緩やかに一定ペースで上昇
    ハイペース追込型: 最後に急上昇

  ■ 上がり3Fの相対値:
    上がり3F - レース全体の平均上がり3F
    ハイペース追込型: 大きな負の値（全体より圧倒的に速い）
    スロー捲り型: 小〜中程度の負の値

  ■ 3-4角間のポジション変動:
    3角順位 - 4角順位
    スロー捲り型: 大きい正の値（3→4角で大きくポジションUP）
    ハイペース追込型: 小さい or 負の値（4角でもまだ後方）
```

---

## 4. なぜこの区別がモデルの精度向上に効くか

### 4-1. 展開との交互作用が正反対

```
現在のモデルの問題:
  「差し脚質」× 「逃げ馬3頭」→ LightGBMは「差し有利」と学習。

しかし実際は:
  逃げ馬3頭 → ハイペース → ハイペース追込型にとって最高の展開
  逃げ馬3頭 → ハイペース → スロー捲り型にとっては普通（捲る必要がない）

  逃げ馬0頭 → スローペース → スロー捲り型にとって最高の展開
  逃げ馬0頭 → スローペース → ハイペース追込型にとって最悪（届かない）

→ 「差し」を一括りにすると、この逆方向の効果が平均化されて
  モデルの予測精度が落ちる。
→ サブタイプを区別すれば、交互作用が正しく学習される。
```

### 4-2. 着順分布の形状が異なる

```
[馬の着順分布の形状](horse_performance_distribution.md) との接続:

スロー捲り型:
  → 安定好走型に近い（3着以内率が高く、大敗も少ない）
  → 複勝・ワイドの堅い相手
  → 着順標準偏差が低め

ハイペース追込型:
  → 一発型に近い（1着か大敗かの二極化）
  → 単勝・三連単の穴馬
  → 着順標準偏差が高め

→ 馬券種の選択にも影響する。
  スロー捲り型: 複勝・ワイドで安定的に拾う
  ハイペース追込型: 条件が揃った時だけ単勝・三連単で狙う
```

### 4-3. 「ペース予想×差しサブタイプ」で期待値が変わる

```
AIモデルのEV計算への影響:

■ スローペース予想のレース:
  スロー捲り型の期待値: 高い（自ら動いて好走できる）
  ハイペース追込型の期待値: 低い（前が止まらない→届かない）

■ ハイペース予想のレース:
  スロー捲り型の期待値: 普通（特に有利でも不利でもない）
  ハイペース追込型の期待値: 高い（最高の展開）

→ オッズは「差し馬」として一括りに評価されている可能性。
  「スローペース予想なのにハイペース追込型を買う」
  「ハイペース予想なのにスロー捲り型を買う」
  は期待値が低い → これを避けるだけでも回収率改善。

逆に:
  「スローペース予想でスロー捲り型を買う」
  は市場が見逃しているエッジの可能性。
  特に「差し馬=ハイペース向き」という一般認識があるため、
  スロー展開での差し馬は軽視されがち。
```

---

## 5. さらに深い分類: 差し馬の4サブタイプ

```
2軸で分類するとより精密になる:

軸1: 仕掛けの早さ（早仕掛け / 遅仕掛け）
軸2: ペース適性（スロー向き / ハイ向き）

┌──────────────────────┬───────────────────┬───────────────────┐
│                      │ 早仕掛け          │ 遅仕掛け          │
├──────────────────────┼───────────────────┼───────────────────┤
│ スロー向き           │ ① スロー捲り型    │ ② スロー直線型    │
│                      │ 3角から動く       │ 直線まで待つが    │
│                      │ ロングスパート     │ スロー時に好走    │
├──────────────────────┼───────────────────┼───────────────────┤
│ ハイ向き             │ ③ ハイ早仕掛け型  │ ④ ハイ追込型      │
│                      │ ハイペースでも     │ 後方から直線で    │
│                      │ 早めに動く（稀）   │ 爆発的な末脚      │
└──────────────────────┴───────────────────┴───────────────────┘

① スロー捲り型: 持続力が武器。スローで自ら展開を作る。安定型。
② スロー直線型: 瞬発力もあるが、スローでないと上がりが活きない。
                 上がり3Fが極端に速いがスロー限定。
③ ハイ早仕掛け型: 稀なタイプ。ハイペースでも早めに動いて
                   先行馬を捕まえに行く。スタミナ型の強い馬。
④ ハイ追込型: 典型的な追込馬。ハイペースで前が止まった時だけ。

★ ただし4分類にするとサンプルサイズが問題になる。
  まずは2分類（スロー型 / ハイ型）で効果を検証し、
  効果があれば4分類に拡張する段階的アプローチが現実的。
```

---

## 6. 特徴量設計

### 差しサブタイプ系の新特徴量

```
■ F20: ペース別好走率差（スロー - ハイ）
  定義: スローペースレースでの好走率 - ハイペースレースでの好走率
  計算:
    slow_hit_rate = (スローペースレースでの3着以内回数) / (スローペースレース出走数)
    high_hit_rate = (ハイペースレースでの3着以内回数) / (ハイペースレース出走数)
    feature = slow_hit_rate - high_hit_rate
  解釈:
    正: スロー向き差し（捲り型）
    負: ハイ向き差し（追込型）
    0近辺: ペース不問の汎用型
  難度: 低
  注意: サンプルサイズが小さい馬は信頼性低い → 信頼度のweight付け

■ F21: 平均仕掛けポイント
  定義: 過去走で最もポジションが上がり始めたコーナーの平均
  計算:
    各走で(N角順位 - (N+1)角順位)が最大のNを特定
    → 平均値を計算
  解釈:
    2-3角: 早仕掛け型（捲り型の可能性）
    4角以降: 遅仕掛け型（直線勝負型の可能性）
  難度: 中

■ F22: 上がり3Fの相対的な突出度
  定義: 上がり3F順位 / (4角通過順位 - 着順)
  計算:
    上がり3Fが最速 and 4角から大きく順位UP → 瞬発力型
    上がり3Fが中位 but 3角から徐々に順位UP → 持続力型
  難度: 低
  ★ 直接的な計算よりも:
    - 過去走の上がり3F順位の平均
    - 過去走の(3角順位-4角順位)の平均
    を個別に入れた方がLightGBMが交互作用を学習しやすい可能性。

■ F23: 差しサブタイプ × 今回のペース予想
  定義: F20(ペース別好走率差) × 予想RPCI の交互作用
  計算:
    F20 > 0 (スロー型) × RPCI < 0.95 (スロー予想) → 高い値（好条件）
    F20 < 0 (ハイ型) × RPCI > 1.05 (ハイ予想) → 高い値（好条件）
    ミスマッチ → 低い値（悪条件）
  難度: 中
  ★ LightGBMに個別に入れても学習可能だが、
    明示的に交互作用を作ると学習が早い可能性。

■ F24: スパート持続距離（推定）
  定義: 「ポジションが上がり始めた地点」から「ゴール」までの距離
  計算:
    仕掛けポイント（F21）× コーナー間の距離 → 残り距離に変換
  解釈:
    残り800m以上: ロングスパート型（スロー捲り型）
    残り600m: 標準
    残り400m以下: ショートスパート型（ハイ追込型）
  難度: 中（コース形態のルックアップテーブルが必要）
```

---

## 7. 「汎用型差し」という第3のタイプ

```
現実には、スロー型でもハイ型でもない差し馬も多い:

■ 汎用型差し（ペース不問型）:
  - どのペースでもそこそこ走れる
  - 上がりは常に上位だが最速ではない
  - 安定して4-5着に来るが、1着になりにくい
  - 騎手の指示に従順（「乗りやすい馬」）

  特徴:
    F20(ペース別好走率差)が0に近い
    着順標準偏差が中程度
    上がり3F順位が常に3-5位

  馬券的には:
  → 複勝・ワイドの相手として信頼度が高い
  → 単勝の期待値は低い（1着になりにくい）
  → 展開に左右されないので、予測の確度が高い

★ このタイプは「展開リスクが低い馬」として
  [展開リスク指数](smooth_trip_without_simulation.md) の
  逆の概念として位置づけられる。
  展開が読みにくいレースでも、汎用型差し馬は
  比較的安定した結果を出す → 堅い軸馬候補。
```

---

## 8. 馬券戦略との統合

### ペース予想に基づく差し馬の使い分け

```
■ スローペース予想のレース:
  買い: スロー捲り型の差し馬
  消し: ハイペース追込型の差し馬
  理由: 前が止まらない → 追込型は届かない
        捲り型は自ら動いて勝負できる

■ ハイペース予想のレース:
  買い: ハイペース追込型の差し馬
  消し: スロー捲り型の差し馬（△、完全な消しではない）
  理由: 前が止まる → 追込型が差し届く
        捲り型もハイペースの恩恵は受けるが、追込型ほどではない

■ ペース不明のレース:
  買い: 汎用型差し馬（F20 ≈ 0）
  消し: 極端な特化型（スロー特化 or ハイ特化）
  理由: ペースが読めない → どちらに転んでも走れる馬が安全

★ ペース予想の精度が低い段階では、汎用型を重視する方が合理的。
  ペース予想の精度が上がってきたら、特化型の使い分けが活きる。
```

### 「差し馬の過剰軽視」を狙う

```
一般的な競馬ファンの認識:
  「スローペース = 前残り = 差し馬は買わない」

これは部分的に正しいが:
  スロー捲り型の差し馬は、スローでこそ好走する。
  「差し馬 = スローで不利」という一般認識は、
  ハイペース追込型にしか当てはまらない。

→ スローペース予想のレースで、スロー捲り型の差し馬が
  「差し馬だから」という理由で軽視されている場合、
  オッズが歪んでいる → 期待値がある。

これは [馬券市場の構造的非効率性](market_structural_inefficiencies.md) の
新たな歪みの候補。
```

---

## 9. 脚質分類の拡張提案

```
従来: 4分類
  逃げ / 先行 / 差し / 追込

提案: 7分類（段階的に導入）

Step 1: 基本4分類（現在）
  逃げ / 先行 / 差し / 追込

Step 2: 差しの2分割（まずここ）
  逃げ / 先行 / 差し-持続型 / 差し-瞬発型 / 追込

Step 3: 各タイプのペース適性も追加
  逃げ / 先行 / 差し-スロー捲り / 差し-汎用 / 差し-ハイ / 追込-ハイ / 追込-超ハイ

★ ただし分類数を増やすほど:
  - サンプルサイズが減る
  - 過学習リスクが上がる
  - 分類自体の精度が問われる

→ 分類カテゴリとして使うより、
  連続値の特徴量（F20-F24）として入れる方が実用的。
  LightGBMが「この特徴量の値がこの範囲の時に好走」を
  自動で見つけてくれる → 人間が分類する必要がない。
```

---

## 10. 他のinsightsとの接続

| この考察の論点 | 関連するinsight |
|---|---|
| マクリの定義と検出 | [マクリ・ペースクラッシャーの影響](pace_crasher_and_makuri.md) |
| 展開依存の確率変動 | [展開シミュレーションと条件付き着順予測](race_scenario_simulation.md) |
| 着順分布の3類型（安定/好走/一発） | [馬の着順分布の形状](horse_performance_distribution.md) |
| 展開リスク指数とレース選別 | [スムーズな走りと展開予測の必要性](smooth_trip_without_simulation.md) |
| ペース系特徴量 | [features.md](../features.md) ペース・ラップ系 |
| 脚質×枠番×コースの交互作用 | [1コーナーまでの距離と枠順バイアス](start_to_first_corner_gate_bias.md) |
| オッズの歪みと市場の非効率性 | [馬券市場の構造的非効率性](market_structural_inefficiencies.md) |

---

## アクションアイテム

- [ ] RPCIを使ったレースペース判定の実装
- [ ] 馬ごとのペース別好走率（F20）の集計と分布の確認
- [ ] 3角→4角ポジション変動パターンの分析（捲り型の検出精度検証）
- [ ] 「スロー予想×差し馬の人気」の分析（スロー型差しが軽視されているか）
- [ ] 差しサブタイプ特徴量（F20-F24）追加時のモデル精度変化の検証
- [ ] 上がり3F順位×ペース×着順の三重クロス分析

## タグ

`#ペース` `#展開` `#特徴量` `#モデル` `#馬券戦略`
