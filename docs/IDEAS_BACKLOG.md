# アイデアバックログ

気づいたときに書き留める「いつかやりたいこと」リスト。
すぐには実現が難しくても、記録しておけばタイミングが来たときに活かせる。

> **関連ドキュメント**:
> - `knowledge/consideration_master.md` — 思想・戦略フレームワーク
> - `knowledge/features.md` — ML特徴量の実装済み/候補リスト
> - `ml-experiments/README.md` — ML実験ログ

---

## 記録ルール

- **思いついたら即追記**（完成度は問わない）
- 各アイデアに `[分類]` と `追加日` をつける
- 実装したら ~~取り消し線~~ + 実装バージョンを記載
- 定期的にレビューして優先度を見直す

### 分類タグ
| タグ | 内容 |
|------|------|
| `[特徴量]` | ML特徴量のアイデア |
| `[分析]` | データ分析・可視化 |
| `[戦略]` | 購入戦略・資金管理 |
| `[UI]` | WebViewer機能 |
| `[基盤]` | データパイプライン・インフラ |
| `[学習]` | ふくだ君の学習テーマ |

---

## アイデアリスト

### 特徴量・ML

- `[特徴量]` 2026-02-12: **展開シミュレーション** — 同レースの逃げ馬頭数×脚質の交互作用でペースを予測。ハイペース時に差し馬が有利になるパターンを検出。
- `[特徴量]` 2026-02-12: **着順標準偏差** — 過去5走の着順のばらつき。安定型（堅軸）vs一発型（穴馬）の分類。低難度で新しいシグナルになる可能性。
- `[特徴量]` 2026-02-12: **盛り返し強度** — レース中に一度後退してから巻き返す馬の検出。(最悪位置-着順)/(最悪-最良)。戦意の強さの指標。
- `[特徴量]` 2026-02-12: **上がり3F順位vs着順ギャップ** — 末脚は使えたのに着順が悪かった馬＝展開不利で実力以下の結果。巻き返し候補の検出。
- `[特徴量]` 2026-02-12: **ポジショニングコスト** — 枠番×脚質から期待される1角順位と実際の乖離。無理してポジションを取った馬は消耗している可能性。
- `[特徴量]` 2026-02-12: **マクリ率・ペースクラッシャー検出** — 騎手のマクリ傾向×馬の脚質×コース条件。展開崩壊のリスク指標。
- `[特徴量]` 2026-02-12: **馬主タイプ別のオッズ歪み** — 大規模クラブ馬主（シルク、キャロット等）の応援馬券効果でオッズが歪む。Model Bで活用可能。
- `[特徴量]` 2026-02-12: **併せ馬テキスト解析** — 先着/遅れ/同入の数値化、相手馬のクラス考慮。現在の`oikiri_has_awase`（有無のみ）の高度化。

### 分析・可視化

- `[分析]` 2026-02-12: **全コースラップ傾向マップ** — 場所×距離×トラック別のRPCI分布・前傾/後傾傾向・有利脚質をまとめたデータベース。
- `[分析]` 2026-02-12: **追い切りタイムの相対評価** — コース（坂路/ウッド/CW/ポリ）× 馬場状態（良/稍/重）で正規化。「坂路67秒は速いのか遅いのか」を判定可能に。
- `[分析]` 2026-02-12: **降格ローテ検出** — rating_standardsの基準タイムを使い、「前走の相手レベル >> 今走の相手レベル」の馬を自動抽出。
- `[分析]` 2026-02-12: **Value Bet的中パターン分析** — 過去のVB判定で的中したケースの共通パターンを分析。どの条件でVBが機能しやすいか。
- `[分析]` 2026-02-12: **馬場傾向のリアルタイム反映** — 当日の前半レース結果から馬場バイアス（内有利/外有利）を推定し、後半レースの予測に反映。

### 購入戦略

- `[戦略]` 2026-02-12: **ケリー基準の実装** — 期待値だけでなく、バンクロールに対する最適賭け額を計算。過剰ベットの防止。
- `[戦略]` 2026-02-12: **馬券種の最適化** — 単勝だけでなく、複勝・ワイド・馬連のEV計算。VB馬が2頭以上いるレースでの組み合わせ馬券。
- `[戦略]` 2026-02-12: **購入レース選別** — 全レース購入ではなく、モデルの確信度が高いレースのみに絞る戦略。確信度の定量化方法。

### UI・WebViewer

- `[UI]` 2026-02-12: **馬プロフィールページ** — 過去走一覧・距離/馬場/コース適性・調教履歴・成長曲線の表示。
- `[UI]` 2026-02-12: **予測の根拠表示** — 「なぜこの馬がValue Betなのか」をSHAP値や特徴量重要度で説明。
- `[UI]` 2026-02-12: **収支ダッシュボード** — 月別/条件別の収支推移、VBギャップ別のROI、ドローダウン表示。

### 基盤・パイプライン

- `[基盤]` 2026-02-12: **TARGETオッズ連携** — レース前の最新オッズをTARGETから取得する仕組み。v4.6の最優先項目。
- `[基盤]` 2026-02-12: **point-in-time統計** — 調教師・騎手の成績をレース日時点で区切って集計。時間的リーク解消。
- `[基盤]` 2026-02-12: **週次パイプライン自動化** — 金曜夜のデータ構築→スクレイプ→ML予測を自動実行。cron/タスクスケジューラ。

### 学習テーマ

- `[学習]` 2026-02-12: **LightGBMのハイパーパラメータ感度** — num_leaves, learning_rate, feature_fractionが結果にどう影響するか。Optunaの前に手動で理解を深める。
- `[学習]` 2026-02-12: **SHAP値の解釈** — 個別予測の説明可能性。「なぜこの馬が高スコアなのか」を特徴量寄与で説明できるようになる。
- `[学習]` 2026-02-12: **時系列Cross-Validation** — Walk-Forward分割での検証。過学習をより正確に検出できる。
- `[学習]` 2026-02-12: **ペース理論の基礎** — RPCI, ラップ分析の競馬理論的な背景。前傾/後傾ラップが脚質に与える影響の理解。
- `[学習]` 2026-02-12: **ケリー基準の数学** — 期待値がプラスのときの最適賭け額の導出。fractional Kelly（保守的運用）の考え方。

---

## 実装済み（アーカイブ）

> 実装されたアイデアはここに移動

（まだなし）

---

**最終更新**: 2026-02-12（カカシ + ふくだ君）
