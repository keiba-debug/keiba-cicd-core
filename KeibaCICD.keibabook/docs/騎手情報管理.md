# 騎手情報管理システム

## 概要
騎手の成績データを管理し、予想に活用するためのシステムです。

## データ構造

```
Z:/KEIBA-CICD/data/jockeys/
├── profiles/               # 騎手プロファイル
│   └── {騎手ID}_{騎手名}.md
├── stats/                  # 成績統計
│   └── {年}/
│       ├── monthly/        # 月次成績
│       └── yearly.json     # 年次成績
└── leading/                # リーディング情報
    └── {年}/
        └── {年月}.json
```

## 使用方法

### 1. リーディング情報取得
```bash
# 現在月のリーディング取得
python -m src.jockey_cli leading

# 特定年月のリーディング取得
python -m src.jockey_cli leading --year 2025 --month 9
```

### 2. 騎手プロファイル取得
```bash
# 特定騎手の詳細情報取得
python -m src.jockey_cli profile {騎手ID} --name {騎手名}

# 例: ルメール騎手
python -m src.jockey_cli profile 00666 --name ルメール
```

### 3. 一括更新
```bash
# 上位20名の騎手情報を更新
python -m src.jockey_cli update --top 20

# 特定日のレースに騎乗した騎手を更新
python -m src.jockey_cli update --date 2025/09/14
```

## プロファイル形式

騎手プロファイルは以下の情報を含みます:

### 基本情報
- 騎手ID
- 所属（美浦/栗東）
- 免許取得年

### 成績統計
- 通算成績（勝利数、勝率、連対率、複勝率）
- 今年の成績（月別）
- 得意条件（距離、競馬場、馬場）

### 騎乗馬との相性
- 特定馬との騎乗実績
- 成績と勝率

### 特記事項
- 騎乗傾向（逃げ・先行・差し・追込）
- 乗り替わり成績（他騎手からの変更時の成績）

## 予想への活用

### 1. 騎手乗り替わり分析
- 成績下位騎手から上位騎手への変更を検出
- 乗り替わり後の成績向上率を参考に

### 2. 騎手×馬の相性
- 過去の騎乗実績から相性を判断
- 初騎乗か、実績ありかを確認

### 3. 得意条件マッチング
- レース条件と騎手の得意条件を照合
- 競馬場、距離、馬場状態での過去成績を参照

### 4. 騎手の調子判断
- 直近1ヶ月の成績推移
- リーディング順位の変動

## 実装ファイル

- `src/scrapers/jockey_scraper.py` - 騎手情報スクレーパー
- `src/jockey_cli.py` - コマンドラインインターフェース
- `test_jockey.py` - テスト用スクリプト

## 注意事項

1. **Cookie設定が必要**
   - 競馬ブックへのアクセスには有効なCookie設定が必要
   - `.env`ファイルに設定を記載

2. **データ更新頻度**
   - リーディング情報は週1回程度の更新を推奨
   - 重要な騎手は開催日ごとに更新

3. **スクレイピング負荷**
   - 大量の騎手情報を一度に取得する際は適度な間隔を設ける
   - サーバーへの負荷を考慮して実行

## 今後の拡張案

1. **成績自動集計**
   - レース結果から騎手成績を自動更新

2. **騎手評価指標**
   - 独自の騎手評価指標を算出
   - 期待値ベースの騎手ランキング

3. **騎手コメント収集**
   - レース後の騎手コメントを蓄積
   - 馬の状態把握に活用

---
*最終更新: 2025-09-13*