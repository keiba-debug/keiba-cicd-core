# クイックスタート - 高速版データ取得システム

## 🚀 5分で始める高速データ取得

### 1. 環境準備（初回のみ）

```bash
# リポジトリをクローン
git clone [repository_url]
cd keiba-cicd-core/KeibaCICD.keibabook

# パッケージインストール
pip install -r requirements.txt

# .envファイル作成
echo "KEIBA_DATA_ROOT_DIR=./data" > .env
echo "KEIBABOOK_SESSION=your_session" >> .env
echo "KEIBABOOK_TK=your_tk" >> .env
echo "KEIBABOOK_XSRF_TOKEN=your_token" >> .env
```

### 2. Cookie取得

1. Chrome/Edgeで https://p.keibabook.co.jp にログイン
2. F12キー → Application → Cookies
3. 以下の3つの値をコピー：
   - `keibabook_session`
   - `tk`
   - `XSRF-TOKEN`

### 3. 基本コマンド

#### 今日のレースデータを取得

```bash
# 今日の日程を確認
python -m src.fast_batch_cli schedule --start-date $(date +%Y/%m/%d)

# 全データを高速取得
python -m src.fast_batch_cli full --start-date $(date +%Y/%m/%d) \
  --delay 0.5 --max-workers 10
```

#### 特定日のデータ取得

```bash
# 2025年8月9日のデータ
python -m src.fast_batch_cli full --start-date 2025/08/09 \
  --delay 0.5 --max-workers 10
```

#### 週末2日間のデータ取得

```bash
python -m src.fast_batch_cli full \
  --start-date 2025/08/09 \
  --end-date 2025/08/10 \
  --delay 0.5 --max-workers 8
```

## ⚡ パフォーマンス最適化

### 推奨設定

| 用途 | delay | max-workers |
|------|-------|-------------|
| 安定重視 | 1.0 | 5 |
| バランス | 0.5 | 8 |
| 最高速 | 0.3 | 10-15 |

### 実行例

```bash
# 安定重視
python -m src.fast_batch_cli full --start-date 2025/08/09 \
  --delay 1.0 --max-workers 5

# バランス（推奨）
python -m src.fast_batch_cli full --start-date 2025/08/09 \
  --delay 0.5 --max-workers 8

# 最高速
python -m src.fast_batch_cli full --start-date 2025/08/09 \
  --delay 0.3 --max-workers 15
```

## 📊 データ統合

取得したデータを1ファイルに統合：

```bash
# 単一レース
python -m src.integrator_cli single --race-id 202508090101

# 日付の全レース
python -m src.integrator_cli batch --date 2025/08/09
```

## 📁 データ整理

```bash
# ファイルを年/月/日/競馬場別に整理
python -m src.organizer_cli organize --copy

# 特定日のファイルを検索
python -m src.organizer_cli find --date 2025/08/09
```

## 🔍 動作確認

```bash
# ログ確認
tail -f logs/fast_batch_cli_*.log

# データファイル確認
ls -la data/*.json

# 統合ファイル確認
ls -la data/integrated/*.json
```

## ⚠️ 注意事項

1. **初回実行**: Cookieが正しいか少量のデータで確認
2. **大量取得**: `--delay 0.5`以上を推奨
3. **エラー時**: ログファイルで詳細確認

## 💡 Tips

### PowerShellでの日付指定

```powershell
# 今日
python -m src.fast_batch_cli full --start-date (Get-Date -Format "yyyy/MM/dd")

# 明日
python -m src.fast_batch_cli schedule --start-date (Get-Date).AddDays(1).ToString("yyyy/MM/dd")
```

### 特定データのみ取得

```bash
# 成績のみ
python -m src.fast_batch_cli data --start-date 2025/08/09 \
  --data-types seiseki --max-workers 10

# 出走表と調教のみ
python -m src.fast_batch_cli data --start-date 2025/08/09 \
  --data-types shutsuba,cyokyo --max-workers 8
```

---

**5分で高速データ取得を開始できます！**